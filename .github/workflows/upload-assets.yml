name: Upload Assets
on: [push]
jobs:
  upload:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4  # Updated to the latest version

    - name: Set up Git user
      run: |
        git config --global user.name "CyanRayyan"
        git config --global user.email "1dangmax@hdsb.ca"

    - name: Create assets directory
      run: mkdir -p assets

    - name: Download and extract assets
      run: |
        cd assets
        wget -qO- "https://dl.dropboxusercontent.com/scl/fi/fbuiy99tb218akvy6u9bg/Potato-By-Tyler-Dang.zip?dl=1" | tar -xz

    - name: Debug directory structure
      run: |
        echo "Current directory structure:"
        ls -R

    - name: Commit and push assets
      env:
        GITHUB_TOKEN: ${{ secrets.POTATO_KEY }}
      run: |
        echo "Starting Git operations"
        git add .
        git status  # Debugging to see what files are staged
        git commit -m "Add assets" || echo "No changes to commit"  # Handle no changes scenario
        git push || echo "Push failed"
        echo "Git operations completed"
